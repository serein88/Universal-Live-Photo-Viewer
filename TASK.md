# TASK.md

## 状态说明
- `待进行`：已定义但尚未开始。  
- `进行中`：当前唯一正在执行的任务。  
- `失败`：本轮无法完成，已记录阻塞与建议。  
- `待确认`：已完成实现与验证，等待用户确认。  
- `完成`：用户确认通过后归档。

## 任务列表（待进行按优先级排序）
| 任务编号 | 任务名                            | 状态  | 目标                                               | 验收标准                                                             | 备注                |
| :--- | :----------------------------- | :-- | :----------------------------------------------- | :--------------------------------------------------------------- | :---------------- |
| T1   | 搭建 Vibe Coding 流程管理文件          | 完成  | 建立 `AGENTS.md`、`TASK.md`、`PROGRESS.md` 并落地协作规范   | 1) 三个文件存在且结构完整；2) `AGENTS.md` 包含流程约束与哲学来源；3) `PROGRESS.md` 有本轮记录 | 2026-02-18 用户确认完成 |
| T2   | Phase 1 解析器脚手架（V1）             | 待进行 | 搭建 `IOSParser` 与 `MotionPhotoParser` 的最小可运行骨架    | 1) 可扫描样本目录；2) 可识别类型并输出解析结果；3) 基础单测可运行                            | 母任务（由子任务驱动）       |
| T2-1 | Phase 1 解析器脚手架（V1）-接口与模型       | 待进行 | 建立 `LivePhotoEntity`、`LivePhotoParser`、类型枚举等核心定义 | 1) 接口与模型可编译；2) 字段满足 V1 解析需求                                      | T2 子任务            |
| T2-2 | Phase 1 解析器脚手架（V1）-iOS 解析骨架    | 待进行 | 实现 `IOSParser` 的 UUID 配对与同目录兜底配对                 | 1) 可输出匹配结果；2) 异常样本有明确错误信息                                        | T2 子任务            |
| T2-3 | Phase 1 解析器脚手架（V1）-Motion 解析骨架 | 待进行 | 实现 XMP Offset 读取与视频切片基础流程                        | 1) 可解析 `MicroVideoOffset`；2) 可生成可播放 `.mp4`                       | T2 子任务            |
| T2-4 | Phase 1 解析器脚手架（V1）-命令行验证入口     | 待进行 | 提供脚本入口用于批量扫描样本并输出结果                              | 1) 支持输入目录；2) 输出结构化结果（JSON/表格）                                    | T2 子任务            |
| T3   | 样本验证工具与验收基线                    | 待进行 | 建立批量验证脚本与报告格式                                    | 1) 输出识别率与可播放率；2) 能复现失败样本清单                                       | 母任务（由子任务驱动）       |
| T3-1 | 样本验证工具与验收基线-样本规范               | 待进行 | 制定样本目录结构与元数据清单模板                                 | 1) 有统一目录规范；2) 清单字段可覆盖验收指标                                        | T3 子任务            |
| T3-2 | 样本验证工具与验收基线-统计脚本               | 待进行 | 计算识别率、可播放率、失败类型分布                                | 1) 输出统计摘要；2) 支持重复运行对比                                            | T3 子任务            |
| T3-3 | 样本验证工具与验收基线-失败报告               | 待进行 | 生成失败样本明细与复现命令                                    | 1) 报告含文件路径与失败原因；2) 可直接复现                                         | T3 子任务            |
| T4   | Windows MVP 查看器                | 待进行 | 完成目录扫描、分页查看与双层播放基础交互                             | 1) 本地可浏览并播放 V1 样本；2) 关键交互可复现                                     | 母任务（由子任务驱动）       |
| T4-1 | Windows MVP 查看器-工程初始化          | 待进行 | 搭建 Flutter Desktop 工程并配置窗口基础能力                   | 1) 可启动运行；2) 自定义窗口生效                                              | T4 子任务            |
| T4-2 | Windows MVP 查看器-目录扫描与列表        | 待进行 | 实现“选目录 -> 递归扫描 -> 列表渲染”                          | 1) 可展示样本列表；2) 支持刷新重扫                                             | T4 子任务            |
| T4-3 | Windows MVP 查看器-双层播放器          | 待进行 | 实现静图底层 + 视频上层播放链路                                | 1) 切换与播放可用；2) 播放结束可回退静图                                          | T4 子任务            |
| T4-4 | Windows MVP 查看器-桌面交互           | 待进行 | 实现滚轮切图与键盘左右切换                                    | 1) 两种交互都可用；2) 焦点切换稳定                                             | T4 子任务            |
| T5   | 移动端适配（Android/iOS）             | 待进行 | Android 侧载权限流 + iOS 文档导入流                        | 1) Android 可读取目标目录；2) iOS 文档目录可导入并播放                             | 母任务（由子任务驱动）       |
| T5-1 | 移动端适配（Android/iOS）-Android 权限流 | 待进行 | 完成 `MANAGE_EXTERNAL_STORAGE` 申请与拒绝兜底流程           | 1) 首次授权流程完整；2) 拒绝后提示明确                                           | T5 子任务            |
| T5-2 | 移动端适配（Android/iOS）-iOS 导入流     | 待进行 | 配置文档共享并实现导入目录扫描                                  | 1) 文档目录可见；2) 导入文件可被扫描                                            | T5 子任务            |
| T5-3 | 移动端适配（Android/iOS）-触控优化        | 待进行 | 优化移动端缩放、拖拽、翻页手势冲突                                | 1) 双指缩放稳定；2) 翻页误触降低                                              | T5 子任务            |
| T6   | 导出与缓存治理                        | 待进行 | 完成 GIF/视频/静图导出与缓存清理                              | 1) 三类导出可用；2) 临时文件可回收                                             | 母任务（由子任务驱动）       |
| T6-1 | 导出与缓存治理-导出服务封装                 | 待进行 | 封装 FFmpeg 调用层与任务状态回调                             | 1) 可执行导出任务；2) 错误码与日志可追踪                                          | T6 子任务            |
| T6-2 | 导出与缓存治理-GIF 参数化                | 待进行 | 增加 FPS、尺寸等可配置导出参数                                | 1) 参数可配置；2) 输出符合参数预期                                             | T6 子任务            |
| T6-3 | 导出与缓存治理-缓存回收                   | 待进行 | 实现临时视频生命周期管理与定期清理                                | 1) 退出/重扫可清理；2) 无误删用户导出文件                                         | T6 子任务            |
| T7   | 协议扩展（非 V1）                     | 待进行 | 补齐 `Vivo/Huawei/OPPO` 解析能力                       | 1) 新协议可识别；2) 样本回归可通过                                             | 母任务（后续版本）         |
| T7-1 | 协议扩展（非 V1）-Vivo 解析器            | 待进行 | 实现 Vivo 私有标记识别与切片                                | 1) 可识别 Vivo 样本；2) 可输出可播放视频                                       | T7 子任务            |
| T7-2 | 协议扩展（非 V1）-Huawei 解析器          | 待进行 | 实现 `ubiff` / XMP 特征解析流程                          | 1) 可识别 Huawei 样本；2) 失败原因可定位                                      | T7 子任务            |
| T7-3 | 协议扩展（非 V1）-OPPO 解析器            | 待进行 | 基于样本补齐 OPPO 协议规则                                 | 1) 可识别 OPPO 样本；2) 规则可复用                                          | T7 子任务            |
| T7-4 | 协议扩展（非 V1）-回归集维护               | 待进行 | 建立三厂商样本回归与对比报告                                   | 1) 回归报告可生成；2) 历史结果可对比                                            | T7 子任务            |
