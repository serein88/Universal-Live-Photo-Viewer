# TASK.md

## 状态说明
- `待进行`：已定义但尚未开始。  
- `进行中`：当前唯一正在执行的任务。  
- `失败`：本轮无法完成，已记录阻塞与建议。  
- `待确认`：已完成实现与验证，等待用户确认。  
- `完成`：用户确认通过后归档。

## 看板规则
- 本看板作为 V1 唯一进度面板。  
- 同一时间只允许一个 `进行中` 任务。  
- 子任务命名遵循“母任务 + 后缀”，并紧随母任务。  
- `来源` 用于对齐设计稿与实施计划：  
  - 设计稿：`docs/plans/2026-02-19-technical-route-and-boundaries-design.md`  
  - 实施计划：`docs/plans/2026-02-19-ulpv-v1-foundation.md`

## 任务列表（按优先级）
| 任务编号 | 任务名                                           | 状态  | 目标                                                                     | 验收标准                                                                      | 来源                      | 备注                |
| :--- | :-------------------------------------------- | :-- | :--------------------------------------------------------------------- | :------------------------------------------------------------------------ | :---------------------- | :---------------- |
| T1   | 搭建 Vibe Coding 流程管理文件                         | 完成  | 建立 `AGENTS.md`、`TASK.md`、`PROGRESS.md` 并落地协作规范                         | 1) 三个文件存在且结构完整；2) 流程规范可执行                                                 | 历史任务                    | 2026-02-18 用户确认完成 |
| T8   | 安装 superpowers 技能链路                           | 完成  | 完成 superpowers 克隆与技能发现链接配置                                             | 1) `~/.codex/superpowers` 存在；2) `~/.agents/skills/superpowers` 为 Junction | 历史任务                    | 2026-02-19 用户确认完成 |
| T9   | 当前项目头脑风暴（产品与技术方向）                             | 完成  | 明确 V1 技术路线与需求边界并形成可执行计划                                                | 1) 输出设计稿；2) 输出实施计划；3) 用户确认                                                | 设计稿 + 实施计划              | 2026-02-19 用户确认完成 |
| T10  | 仓库清理与CI触发策略治理                                | 完成  | 清理不应入库文件并将 Windows Build 改为手动触发                                           | 1) 不必要文件加入忽略并从索引移除；2) Actions 仅 `workflow_dispatch` 触发                    | 当前会话                    | 已完成，待你自行 push 触发手动流程 |
| T2   | Phase 1 解析器脚手架（V1）                            | 完成  | 落地 V1 解析基础能力（iOS + Motion）与分层骨架                                        | 1) `T2-1`~`T2-6` 完成；2) 可扫描并识别 V1 样本；3) CLI 可输出结构化结果                       | 实施计划 Task 1~6           | 母任务（由子任务驱动）       |
| T2-1 | Phase 1 解析器脚手架（V1）-项目骨架与测试基线                  | 完成  | 初始化 Flutter 项目与 4 层目录骨架                                                | 1) 工程可运行；2) smoke test 通过                                                 | 实施计划 Task 1             | 对齐架构边界            |
| T2-2 | Phase 1 解析器脚手架（V1）-Domain 实体与解析接口             | 完成  | 建立 `LivePhotoType`、`LivePhotoEntity`、`LivePhotoParser`                 | 1) Domain 可编译；2) 契约测试通过                                                   | 实施计划 Task 2             | 对齐设计稿 §3          |
| T2-3 | Phase 1 解析器脚手架（V1）-Application Ports 与用例编排    | 完成  | 定义 `MediaPickerPort/VideoPlaybackPort/ExportPort/FileSystemPort` 与核心用例 | 1) 业务层不直接依赖插件；2) 用例测试通过                                                   | 实施计划 Task 3             | 对齐设计稿 §4          |
| T2-4 | Phase 1 解析器脚手架（V1）-iOS Parser 骨架              | 完成  | 实现 iOS 双文件匹配解析（UUID 优先）                                                | 1) 解析测试通过；2) 失败返回统一错误码                                                    | 实施计划 Task 4             | 对齐 In Scope       |
| T2-5 | Phase 1 解析器脚手架（V1）-Motion Photo Parser 骨架     | 完成  | 实现 XMP Offset 读取与视频切片                                                  | 1) `MicroVideoOffset` 解析可用；2) 产出可播放 `.mp4`                                | 实施计划 Task 5             | 对齐 In Scope       |
| T2-6 | Phase 1 解析器脚手架（V1）-Parser Registry + CLI 验证入口 | 完成  | 建立 parser 分发注册与 CLI 扫描入口                                               | 1) 支持目录输入；2) 输出 JSON/表格结果                                                 | 实施计划 Task 6             | 支撑后续验收            |
| T3   | 样本验证工具与验收基线                                   | 完成  | 建立 V1 验收与质量门禁                                                          | 1) `T3-1`~`T3-4` 完成；2) 可产出识别率/可播放率报告                                      | 设计稿 §5/§8 + 实施计划 Task 7 | 母任务（由子任务驱动）       |
| T3-1 | 样本验证工具与验收基线-样本规范                              | 完成  | 制定样本目录结构与元数据清单模板                                                       | 1) 样本规范固定；2) 字段覆盖验收指标                                                     | 设计稿 §5.3                | 先做                |
| T3-2 | 样本验证工具与验收基线-统计脚本                              | 完成  | 计算识别率、可播放率、失败类型分布                                                      | 1) 输出统计摘要；2) 支持重复运行对比                                                     | 设计稿 §8.1                | 对齐 95%/100% 指标    |
| T3-3 | 样本验证工具与验收基线-失败报告                              | 完成  | 生成失败样本明细与复现命令                                                          | 1) 报告含文件路径/错误码/阶段；2) 可复现                                                  | 设计稿 §8.2                | Fail Fast 落地      |
| T3-4 | 样本验证工具与验收基线-质量门禁脚本与文档                         | 完成  | 建立测试矩阵脚本与发布门禁文档                                                        | 1) 门禁命令可执行；2) 文档包含发布前检查项                                                  | 实施计划 Task 7 + 设计稿 §6    | 覆盖发布约束            |
| T4   | Windows MVP 查看器                               | 进行中 | 完成目录扫描、分页查看与双层播放基础交互                                                   | 1) 可浏览并播放 V1 样本；2) 关键桌面交互可复现；3) Windows Build 冒烟测试通过                         | 设计稿 §3/§6               | 当前处于 Windows Build 测试阶段，暂不验收 |
| T4-1 | Windows MVP 查看器-工程初始化                         | 待确认 | 配置 Windows 工程与窗口基础能力                                                   | 1) 可启动运行；2) 窗口能力生效                                                        | Roadmap Phase 2         | 进入统一验收前先保留待确认状态 |
| T4-2 | Windows MVP 查看器-目录扫描与列表                       | 待确认 | 实现“选目录 -> 递归扫描 -> 列表渲染”                                                | 1) 可展示样本列表；2) 支持刷新重扫                                                      | Roadmap Phase 2         | 进入统一验收前先保留待确认状态 |
| T4-3 | Windows MVP 查看器-双层播放器                         | 待确认 | 实现静图底层 + 视频上层播放链路                                                      | 1) 切换与播放可用；2) 播放结束回退静图                                                    | Roadmap Phase 2         | 进入统一验收前先保留待确认状态 |
| T4-4 | Windows MVP 查看器-桌面交互                          | 待确认 | 实现滚轮切图与键盘左右切换                                                          | 1) 两种交互可用；2) 焦点切换稳定                                                       | Roadmap Phase 2         | 进入统一验收前先保留待确认状态 |
| T4-5 | Windows MVP 查看器-Windows Build 冒烟测试           | 待确认 | 验证 GitHub Actions 构建产物可下载、可解压、可运行                                      | 1) `workflow_dispatch` 构建成功；2) 本地运行非 Demo 主界面；3) 基础播放链路可观察                          | 当前会话                    | workflow 已拆分 quality/build/publish，支持 sample_tag/build_note 与规范化产物名，待你重跑 Actions 回归验证 |
| T5   | 移动端适配（Android/iOS）                            | 待进行 | 完成 Android 侧载权限流 + iOS 文档导入流                                           | 1) Android 可读取目标目录；2) iOS 文档目录可导入并播放                                      | 设计稿 §6/§7               | 母任务（由子任务驱动）       |
| T5-1 | 移动端适配（Android/iOS）-Android 权限流                | 待进行 | 完成 `MANAGE_EXTERNAL_STORAGE` 申请与拒绝兜底                                   | 1) 首次授权流程完整；2) 拒绝后提示明确                                                    | 设计稿 §6                  | T5 子任务            |
| T5-2 | 移动端适配（Android/iOS）-iOS 导入流                    | 待进行 | 配置文档共享并实现导入目录扫描                                                        | 1) 文档目录可见；2) 导入文件可被扫描                                                     | 设计稿 §6                  | T5 子任务            |
| T5-3 | 移动端适配（Android/iOS）-触控优化                       | 待进行 | 优化移动端缩放、拖拽、翻页手势冲突                                                      | 1) 双指缩放稳定；2) 翻页误触降低                                                       | Roadmap Phase 3         | T5 子任务            |
| T6   | 导出与缓存治理                                       | 待进行 | 完成 GIF/视频/静图导出与缓存清理                                                    | 1) 三类导出可用；2) 临时文件可回收；3) 错误可定位                                             | 设计稿 §4/§7/§8            | 母任务（由子任务驱动）       |
| T6-1 | 导出与缓存治理-导出服务封装                                | 待进行 | 封装 FFmpeg 调用层与任务状态回调                                                   | 1) 导出任务可执行；2) 错误码与日志可追踪                                                   | 设计稿 §4                  | T6 子任务            |
| T6-2 | 导出与缓存治理-GIF 参数化                               | 待进行 | 增加 FPS、尺寸等可配置导出参数                                                      | 1) 参数可配置；2) 输出符合参数预期                                                      | 设计稿 §7                  | T6 子任务            |
| T6-3 | 导出与缓存治理-缓存回收                                  | 待进行 | 实现临时视频生命周期管理与定期清理                                                      | 1) 退出/重扫可清理；2) 不误删用户导出文件                                                  | 设计稿 §8.2                | T6 子任务            |
| T7   | 协议扩展（非 V1）                                    | 待进行 | 补齐 `Vivo/Huawei/OPPO` 解析能力                                             | 1) 新协议可识别；2) 样本回归可通过                                                      | 设计稿 §7.2/§9             | 母任务（后续版本）         |
| T7-1 | 协议扩展（非 V1）-Vivo 解析器                           | 待进行 | 实现 Vivo 私有标记识别与切片                                                      | 1) 可识别 Vivo 样本；2) 可输出可播放视频                                                | 后续扩展                    | T7 子任务            |
| T7-2 | 协议扩展（非 V1）-Huawei 解析器                         | 待进行 | 实现 `ubiff` / XMP 特征解析流程                                                | 1) 可识别 Huawei 样本；2) 失败原因可定位                                               | 后续扩展                    | T7 子任务            |
| T7-3 | 协议扩展（非 V1）-OPPO 解析器                           | 待进行 | 基于样本补齐 OPPO 协议规则                                                       | 1) 可识别 OPPO 样本；2) 规则可复用                                                   | 后续扩展                    | T7 子任务            |
| T7-4 | 协议扩展（非 V1）-回归集维护                              | 待进行 | 建立三厂商样本回归与对比报告                                                         | 1) 回归报告可生成；2) 历史结果可对比                                                     | 后续扩展                    | T7 子任务            |
